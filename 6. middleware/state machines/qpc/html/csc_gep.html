<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QP/C: Guideline Enforcement Plan (GEP)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="ql-preview.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="ql-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectlogo">
    <a href="https://www.state-machine.com" title="Quantum Leaps"><img alt="Logo" src="logo_ql.png"/></a>
  </div>
   <div id="projectname">
    QP/C
    &nbsp;<span id="projectnumber">7.3.4</span>
   </div>
   <div id="projectbrief">Real-Time Embedded Framework</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('csc_gep.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Guideline Enforcement Plan (GEP)</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><span class="prev_button"><a class="el" href="csc.html#csc_scope">Purpose and Scope</a></span><span class="next_button"><a class="el" href="csc_gcs.html">Guideline Compliance Summary (GCS)</a></span> </p>
<p>As recommended in <a class="el" href="csc.html#csc_ref">[MISRA-Comply]</a>, this section presents the <b>MISRA Guideline Enforcement Plan (GEP)</b>. The plan presented here is centered on automatic guideline enforcement of as many guidelines as possible by means of a <b>static analysis tool</b>, which is stipulated by <a class="el" href="csc.html#csc_ref">[MISRA4]</a>, Section 3.2 "Analysis Tools".</p>
<dl class="section remark"><dt>Remarks</dt><dd>The completely automatic enforcement of 100% of the MISRA-C guidelines is not possible and was never intended. Some of the guidelines are only enforceable by manual review of the code or checking the compiler/linker tools by other means.</dd></dl>
<h1><a class="anchor" id="csc_c99"></a>
ISO-C99 Language Standard</h1>
<p><a class="el" href="csc.html#csc_ref">[MISRA4]</a> requires choosing a specific C programming language standard (either C90, C99, or C11) and then consistently configuring all compilers and the static analysis tool to apply this specific C standard (see also <a class="el" href="csc.html#csc_ref">[MISRA4]</a> Section "Selected C Language Standard").</p>
<dl class="section note"><dt>Note</dt><dd>The C language standard chosen for this MISRA-C:2023 compliance is <b>C99</b> (see <a class="el" href="csc.html#csc_ref">[ISO-C99]</a>).</dd></dl>
<h1><a class="anchor" id="csc_proc"></a>
Deviation Process</h1>
<p>As described in "MISRA Compliance" <a class="el" href="csc.html#csc_ref">[MISRA-Comply]</a>, the management of guideline violations is a critical issue. Violations are sometimes unavoidable and a claim of compliance can only be meaningful when they are authorized through a clearly defined process and supported by <a class="el" href="csc_gep.html#csc_dev-per">Deviation Permits (DVPs)</a> and <a class="el" href="csc_gep.html#csc_dev-rec">Deviation Records (DVRs)</a>.</p>
<h2><a class="anchor" id="csc_dev-per"></a>
Deviation Permits (DVPs)</h2>
<p>A <b>Deviation Permit</b> (DVP) defines a <b>common use-case</b> under which a violation is justified and specifies the documentation and process restrictions under which the permit is granted. A DVP contains the following information:</p>
<ul>
<li><em>Guideline</em> &mdash; guideline number</li>
<li><em>Reason</em> &mdash; the reason why the violation is justified (one of the reasons listed in in Section 4.4 of "MISRA Compliance" <a class="el" href="csc.html#csc_ref">[MISRA-Comply]</a></li>
<li><em>Use-Case</em> &mdash; explanation of the common use-case and the language issues</li>
<li><em>Examples</em> &mdash; example(s) of the common use case covered by this Deviation Permit</li>
<li><em>Restrictions</em> &mdash; the specific circumstances in which the Deviation Permit applies. The restrictions may contain a list of code elements (e.g., function names, macro names, file names, etc.) where the violation takes place. (REMARK: The "MISRA Compliance" <a class="el" href="csc.html#csc_ref">[MISRA-Comply]</a> document calls this section of a DVP "Requirements". However, to avoid any confusion with system/software <a class="el" href="srs.html">requirements</a>, this GEP uses the term "Restrictions".)</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Deviation Permits are used in this <em>Guideline Enforcement Plan</em> for deviations that occur in the <b>QP Application</b> code due to design and implementation of the QP Framework. (The deviations might also occur in the QP Framework code.)</dd></dl>
<h2><a class="anchor" id="csc_dev-rec"></a>
Deviation Records (DVRs)</h2>
<p>A <b>Deviation Record</b> (DVR) documents <b>specific circumstance(s)</b> of guideline violation. A DVR contains the following information:</p>
<ul>
<li><em>Guideline</em> &mdash; guideline number</li>
<li><em>Reason</em> &mdash; the reason why the violation is justified (one of the reasons listed in in Section 4.4 of "MISRA Compliance" <a class="el" href="csc.html#csc_ref">[MISRA-Comply]</a></li>
<li><em>Background</em> &mdash; explanation of the deviation context and the language issues</li>
<li><em>Examples</em> &mdash; example(s) of the given guideline violations</li>
<li><em>Restrictions</em> &mdash; the specific circumstances in which the deviation occurs. The restrictions may contain a list of code elements (e.g., function names, macro names, file names, etc.) where the violation takes place. (REMARK: The "MISRA Compliance" <a class="el" href="csc.html#csc_ref">[MISRA-Comply]</a> document calls this section of a DVR "requirements". However, to avoid any confusion with system/software <a class="el" href="srs.html">requirements</a>, this GEP uses the term "restrictions".)</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Deviation Records are used in this <em>Guideline Enforcement Plan</em> for deviations that occur only the <b>QP Framework</b> without impacting the QP Application code.</dd></dl>
<h2><a class="anchor" id="csc_recat"></a>
No Guideline Re-categorization</h2>
<p>The "MISRA Compliance" document <a class="el" href="csc.html#csc_ref">[MISRA-Comply]</a> describes a MISRA-C compliance strategy based on re-categorizing MISRA-C guidelines. While this could be an effective strategy for compliance of <em>specific</em> projects, in the <em>generic</em> infrastructure-type software, like the QP Framework, any guideline re-categorization would change and potentially weaken the carefully designed structure of MISRA-C guidelines. For these reasons, this <em>Guideline Enforcement Plan</em> does <b>not</b> change the categorization of any MISRA-C guidelines, and indeed, does <em>not</em> weaken or disable any guidelines outside the strictly defined contexts and use-cases.</p>
<dl class="section note"><dt>Note</dt><dd>This <em>Guideline Enforcement Plan</em> uses the <b>contextual guideline suppression</b> as the central policy. It means that the <a class="el" href="csc_gep.html#csc_pclp">static analysis tool</a> is configured to suppress diagnostics <em>only</em> in very specific, well defined <em>contexts</em> in which the documented deviation is permitted. <b>In all other contexts, a given guideline should remain in full force by getting checked and reported.</b></dd></dl>
<h1><a class="anchor" id="csc_pclp"></a>
Static Analysis Tool</h1>
<p>This <em>Guideline Enforcement Plan</em> uses <a href="https://pclintplus.com/pc-lint-plus" class="extern" target="_blank" title="PC-Lint-Plus"><b>PC-Lint-Plus</b> (PCLP)</a>, which is a static analysis tool for C and C++ with one of the longest track records and best value of the money in the industry. PC-Lint family of tools have been supporting checks for the MISRA-C guidelines since early 2001, and the company behind the tool is committed to provide ongoing and increasing support for these guidelines.</p>
<p><a href="https://pclintplus.com/pc-lint-plus"><div class="image">
<img src="pc-lint-plus.png" alt=""/>
</div>
     </a>   </p><div class="caption"><center><em>PC-Lint Plus static analysis tool</em></center></div><dl class="section attention"><dt>Attention</dt><dd>The static analysis infrastructure and this MISRA <em>Guideline Enforcement Plan</em> is specific to the selected static analysis tool (PLCP in this case) and would require complete <b>rework</b> to adapt it to any other static analysis tools on the market. Therefore, to take full advantage of the provided MISRA-C compliance infrastructure it is <b>highly recommended</b> that the QP Application software also uses the same <a href="https://pclintplus.com/pc-lint-plus">PLCP static analysis tool</a>.<br  />
</dd></dl>
<h1><a class="anchor" id="csc_pclp-config"></a>
Configuring PCLP</h1>
<p>This section describes how to <b>configure</b> the PCLP static analysis tool for checking MISRA-C:2023 compliance and how to selectively <em>suppress</em> the messages for already known and investigated issues, so that such messages don't keep "polluting" the analysis logs.</p>
<h2><a class="anchor" id="csc_policy"></a>
Diagnostics Suppression Policy</h2>
<p>Once the deviations have been identified and <em>documented</em> in Deviation Permits and Deviation Records, there is no point of generating redundant diagnostics of already known and investigated issues. Indeed, such repetitive diagnostics would be <em>harmful</em>, as it can easily overwhelm the analysis logs and obscure any new deviations that are NOT covered by the existing DVRs and DVPs. This means that the static analysis tool should be configured to suppress diagnostics from known and documented deviations.</p>
<dl class="section attention"><dt>Attention</dt><dd>Static analysis of the QP Framework or QP Application without any suppression of diagnostics is likely to produce a <b>mountain of messages</b>, especially messages from header files that are repeated every time a given header file is included. This is to be expected and is not to be interpreted as lack of quality and non-compliance of QP Framework or QP Applications. Instead, as in any non-trivial code base, it is necessary to apply a <a class="el" href="csc_gep.html#csc_policy">Diagnostics Suppression Policy</a> for the <a class="el" href="csc_dev.html">Deviations documented in this report</a>.</dd></dl>
<h2><a class="anchor" id="csc_pclp-m3"></a>
Checking MISRA-C:2023 Compliance in PCLP</h2>
<p>The primary way of activating checking for MISRA-C:2023 guidelines in PCLP is via the configuration file <code>au-misra4.lnt</code>.</p>
<p>The level of support provided by PCLP for each of the corresponding MISRA-C:2023 guidelines is described in Section 12.1.2 of the <a class="el" href="csc.html#csc_ref">PC-lint Plus User Manual [PCLP]</a>/"MISRA Standards Checking".</p>
<h2><a class="anchor" id="csc_pclp-more"></a>
Additional PCLP Checks</h2>
<p>In addition to the aforementioned MISRA checks, PCLP is configured to perform the following checks</p>
<ul>
<li><code>au-barr.lnt</code> &mdash; <a class="el" href="csc.html#csc_ref">[BARR-C:2018]</a> style guidelines (customized by Quantum Leaps)</li>
<li><code>au-ds.lnt</code> &mdash; <a class="el" href="csc.html#csc_ref">[Saks-1998]</a> Dan Saks' recommendations for placing <code>const/volatile</code></li>
</ul>
<h2><a class="anchor" id="csc_pclp-opt"></a>
PLCP Options</h2>
<p>PCLP has several places where it reads its currently valid options:</p><ul>
<li>From special PC-Lint option files (usually called <code>*.lnt</code>)</li>
<li>From the command line</li>
<li>From within the special lint-comments in the source code modules (not recommended)</li>
</ul>
<p>The QP Framework code and example application code has been "linted" only by means of the first alternative (option files) with possibility of adding options via command line. The third alternative (lint comments) is not used and Quantum Leaps does not recommend this alternative.</p>
<dl class="section remark"><dt>Remarks</dt><dd>The QP Framework code is free of lint-comments, which are viewed as a contamination of the source code.</dd></dl>
<p>The structure of the PCLP option files used for "linting" QP/C follows exactly the published guidelines for configuring PCLP (See Section 3.2 "Configuration" in the PCLP Manual <a class="el" href="csc.html#csc_ref">[PLCP]</a>). The design and grouping of the PCLP options also reflects the fact that static code analysis of a software framework, such as QP/C, has really two major aspects:</p>
<ul>
<li>The <a class="el" href="csc_gep.html#csc_qpc">QP Framework code</a> itself</li>
</ul>
<p>But equally important and helpful to the users of the framework is providing the infrastructure to effectively analyze</p>
<ul>
<li>The <a class="el" href="csc_gep.html#csc_app">Application code</a> based on the QP Framework.</li>
</ul>
<p>With this in mind, <a class="el" href="csc_gep.html#csc_l1">Listing MISRA-1</a> shows that the PCLP options are divided into two files <a class="el" href="qpc_8lnt.html" title="PC-Lint-Plus option file for analysing both QP/C and QP/C Applications">qpc.lnt</a> and <a class="el" href="options_8lnt.html" title="PC-Lint-Plus option file for linting QP/C source code.">options.lnt</a>, located in directory <code>qpc/ports/lint-plus</code>. These two files are for analyzing QP/C source code and Application code, respectively.</p>
<p><a class="anchor" id="csc_l1"></a></p><div class="caption"><center><em>Listing MISRA-1: directories and files for static analysis of QP Framework and QP Application code.</em></center></div> <div class="fragment"><div class="line">&lt;qpc/&gt;                          <span class="comment">// QP/C installation directory</span></div>
<div class="line">|</div>
<div class="line">+---include/                    <span class="comment">// QP/C platform-independent includes</span></div>
<div class="line">|       qpc.h                   <span class="comment">// QP/C header file</span></div>
<div class="line">|       ~ ~ ~</div>
<div class="line">|</div>
<div class="line">+---src/                        <span class="comment">// QP/C platform-independent source code</span></div>
<div class="line">|   |</div>
<div class="line">|   +---qf/                     <span class="comment">// QEP/QF components of QP/C</span></div>
<div class="line">|   +---qk/                     <span class="comment">// QK component of QP/C</span></div>
<div class="line">|   +---qs/                     <span class="comment">// QS component of QP/C</span></div>
<div class="line">|   +---qv/                     <span class="comment">// QV component of QP/C</span></div>
<div class="line">|   +---qxk/                    <span class="comment">// QXK component of QP/C</span></div>
<div class="line">|</div>
<div class="line">+---ports/                      <span class="comment">// QP/C ports directory</span></div>
<div class="line">|   |</div>
<div class="line">|   +---lint-plus/              <span class="comment">// QP/C &quot;port&quot; to PCLP</span></div>
<div class="line">|   |   +---16bit/              <span class="comment">// QP/C &quot;port&quot; to 16-bit CPU</span></div>
<div class="line">|   |   |       cpu.lnt         <span class="comment">// Sizes of integers and pointers for a 16-bit CPU</span></div>
<div class="line">|   |   |       qs_port.h       <span class="comment">// QS  component &quot;port&quot; to a generic 16-bit CPU</span></div>
<div class="line">|   |   |       stdint.h        <span class="comment">// Standard exact-width integers for a 16-bit CPU</span></div>
<div class="line">|   |   |</div>
<div class="line">|   |   +---32bit/</div>
<div class="line">|   |   |       cpu.lnt         <span class="comment">// Sizes of integers and pointers for a 32-bit CPU</span></div>
<div class="line">|   |   |       qs_port.h       <span class="comment">// QS  component &quot;port&quot; to a generic 32-bit CPU</span></div>
<div class="line">|   |   |       stdint.h        <span class="comment">// Standard exact-width integers for a 32-bit CPU</span></div>
<div class="line">|   |   |</div>
<div class="line">|   |   +---qk/                 <span class="comment">// QP/C port to QK real-time kernel</span></div>
<div class="line">|   |   |       qp_port.h</div>
<div class="line">|   |   |</div>
<div class="line">|   |   +---qv/                 <span class="comment">// QP/C port to QV real-time kernel</span></div>
<div class="line">|   |   |       qp_port.h</div>
<div class="line">|   |   |</div>
<div class="line">|   |   +---qxk/                <span class="comment">// QP/C port to QXK real-time kernel</span></div>
<div class="line">|   |   |       qp_port.h</div>
<div class="line">|   |   |</div>
<div class="line">|   |   |   au-misra4.lnt       <span class="comment">// MISRA-C:2023 - compliance options</span></div>
<div class="line">|   |   |   au-barr.lnt         <span class="comment">// BARR-C:2018 - compliance options</span></div>
<div class="line">|   |   |   au-ds.lnt           <span class="comment">// Dan Saks recommendations</span></div>
<div class="line">|   |   |</div>
<div class="line">|   |   |   lin.bat             <span class="comment">// Batch file to invoke PCLP to analyze QP/C</span></div>
<div class="line">|   |   |</div>
<div class="line">|   |   |   lint_qf.log         <span class="comment">// PCLP output for the QF component of QP/C</span></div>
<div class="line">|   |   |   lint_qk.log         <span class="comment">// PCLP output for the QK component of QP/C</span></div>
<div class="line">|   |   |   lint_qs.log         <span class="comment">// PCLP output for the QS component of QP/C</span></div>
<div class="line">|   |   |   lint_qv.log         <span class="comment">// PCLP output for the QV component of QP/C</span></div>
<div class="line">|   |   |   lint_qxk.log        <span class="comment">// PCLP output for the QXK component of QP/C</span></div>
<div class="line">|   |   |</div>
<div class="line">|   |   |   std.lnt             <span class="comment">// PCLP standard settings</span></div>
<div class="line">|   |   |   qpc.lnt             <span class="comment">// &lt;== PCLP settings for QP/C source and applications</span></div>
<div class="line">|   |   |   options.lnt         <span class="comment">// &lt;== PCLP settings for &quot;linting&quot; QP/C source code</span></div>
<div class="line">|   |   |</div>
<div class="line">|   |   |   stdbool.h           <span class="comment">// Standard Boolean type</span></div>
<div class="line">|</div>
<div class="line">+---examples/                   <span class="comment">// QP/C examples directory (Applications)</span></div>
<div class="line">|   |</div>
<div class="line">|   +---arm-cm/                 <span class="comment">// QP/C examples for ARM Cortex-M</span></div>
<div class="line">|   |   +---dpp_ek-tm4c123gxl/  <span class="comment">// DPP example on the EK-TM4C123GLX board</span></div>
<div class="line">|   |   |   +---lint-plus/      <span class="comment">// directory for linting the application</span></div>
<div class="line">|   |   |   |       lin.bat     <span class="comment">// Batch to run PCLP analysis of Application code</span></div>
<div class="line">|   |   |   |       options.lnt <span class="comment">// PCLP options for &quot;linting&quot; of Application code</span></div>
<div class="line">|   |</div>
<div class="line">|   +--- ~ ~ ~                  <span class="comment">// Other examples...</span></div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>The <code>&lt;qpc&gt;/ports/lint-plus</code> directory contains all PCLP option files used in "linting" the code, including the standard MISRA-C:2023 (<code>au-misr3.lnt</code>, <code>au-misr3-amd1.lnt</code>, and <code>au-misr3-amd2.lnt</code> option files) as well as Dan Saks' recommendations <code>au-ds.lnt</code>, which are copied from the PCLP distribution. This design freezes the lint options for which the compliance has been checked.</dd></dl>
<h2><a class="anchor" id="csc_pclp-std"></a>
The std.lnt PLCP file</h2>
<p>According to the PCLP configuration guidelines, the file <a href="std_8lnt_source.html">std.lnt</a> file contains the top-level options, which apply to QP Framework and are recommended for QP Applications.</p>
<p><a class="anchor" id="csc_l2"></a></p><div class="caption"><center><em>Listing MISRA-2: PLCP configuration file <a class="el" href="std_8lnt.html" title="PC-Lint-Plus standard option file.">std.lnt</a></em></center></div> <div class="fragment"><div class="line">file: std.lnt</div>
<div class="line"> </div>
<div class="line">    -zero(99)       <span class="comment">// don&#39;t stop because of warnings</span></div>
<div class="line">[1] -passes(2)      <span class="comment">// make two passes (for better error messages)</span></div>
<div class="line">[2] -restore_at_end <span class="comment">// don&#39;t let -e&lt;nn&gt; options bleed to other files</span></div>
<div class="line">    -summary()      <span class="comment">// output a summary of all produced messages</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// globally suppress the following warnings:</span></div>
<div class="line">[3] -e546           <span class="comment">// explicitly taking address of function</span></div>
<div class="line">[4] -e717           <span class="comment">// monocarpic do-while used to group statements</span></div>
</div><!-- fragment --><p><code>[1]</code> PCLP is configured to make two passes to perform better cross-module analysis.</p>
<p><code>[2]</code> The important option is <code>-restore_at_end</code>, which has the effect of surrounding each source file with options -save and -restore. This precaution prevents options from "bleeding" from one file to another.</p>
<p><code>[3]</code> Global suppression of the warning about explicitly taking address of a function (to create a pointer-to-function, e.g. <code>handler = &amp;Blinky_on</code>). Being explicit about taking an address of a function is the recommended practice in the Quantum Leaps code.</p>
<p><code>[4]</code> monocarpic <code>do-while</code> used to group statements is used in macros that contain multiple statements. Again, this is a recommended practice to avoid any side effects of "dangling" statements.</p>
<h2><a class="anchor" id="csc_pclp-qpc"></a>
The qpc.lnt PLCP file</h2>
<p>The <a class="el" href="qpc_8lnt.html" title="PC-Lint-Plus option file for analysing both QP/C and QP/C Applications">qpc.lnt</a> option file is the most important for "linting" both QP Applications and QP Framework source code as well. This file handles all deviations from the MISRA-C:2023 guidelines, which might arise at the QP Application code from the use of the QP Framework. In other words, the <a class="el" href="qpc_8lnt.html" title="PC-Lint-Plus option file for analysing both QP/C and QP/C Applications">qpc.lnt</a> option file allows clean "linting" of the application-level code, as long as the application code does not violate any of the MISRA-C:2023 guidelines.</p>
<p>At the same time, the <a class="el" href="qpc_8lnt.html" title="PC-Lint-Plus option file for analysing both QP/C and QP/C Applications">qpc.lnt</a> option file has been very carefully designed not to suppress any MISRA-C:2023 guideline checking outside the very specific context of the QP Framework API. In other words, the <a class="el" href="qpc_8lnt.html" title="PC-Lint-Plus option file for analysing both QP/C and QP/C Applications">qpc.lnt</a> option file still supports all of the MISRA-C:2023 guideline checks that PCLP is capable of performing.</p>
<dl class="section remark"><dt>Remarks</dt><dd>The <a class="el" href="qpc_8lnt.html" title="PC-Lint-Plus option file for analysing both QP/C and QP/C Applications">qpc.lnt</a> option file generally contains <a class="el" href="csc_gep.html#csc_dev-per">Deviation Permits</a> for MISRA-C guidelines.</dd></dl>
<h2><a class="anchor" id="csc_pclp-options"></a>
The options.lnt PLCP file</h2>
<p>The <a class="el" href="options_8lnt.html" title="PC-Lint-Plus option file for linting QP/C source code.">options.lnt</a> option file handles all deviations from the MISRA-C:2023 guidelines, which arise in the QP Framework code. These are deviations that are contained within QP Framework and generally don't propagate to the QP Applications.</p>
<dl class="section remark"><dt>Remarks</dt><dd>The <a class="el" href="options_8lnt.html" title="PC-Lint-Plus option file for linting QP/C source code.">options.lnt</a> option file generally contains <a class="el" href="csc_gep.html#csc_dev-rec">Deviation Records</a> for MISRA-C guidelines.</dd></dl>
<h2><a class="anchor" id="csc_pclp-lin"></a>
The lin.bat batch file</h2>
<p>The directory <code>&lt;qpc&gt;/ports/lint-plus</code> (see <a class="el" href="csc_gep.html#csc_l1">Listing MISRA-1</a>) contains also the <code>lin.bat</code> batch file for "linting" the QP Framework code. The <code>lin.bat</code> batch file invokes PCLP and stores the lint output files. As shown in <a class="el" href="csc_gep.html#csc_l1">Listing MISRA-1</a>, the lint output is collected into four text files <code>lint_qf.log</code>, <code>lint_qk.log</code>, lint_qv.log<code>, lint_qxk.log</code> and <code>lint_qs.log</code>, for <a class="el" href="class_q_f.html" title="QF Active Object Framework (QF namespace emulated as a &quot;class&quot; in C)">QF</a>, <a class="el" href="struct_q_k.html" title="QK preemptive non-blocking kernel (QK namespace emulated as a &quot;class&quot; in C)">QK</a>, <a class="el" href="struct_q_x_k.html" title="QXK dual-mode kernel (QXK namespace emulated as a &quot;class&quot; in C)">QXK</a>, and <a class="el" href="struct_q_s.html" title="Software tracing instrumentation, target-resident component (QS namespace emulated as a &quot;class&quot; in C)">QS</a> components of the QP Framework, respectively.</p>
<dl class="section remark"><dt>Remarks</dt><dd>In order to execute the <code>lin.bat</code> file on your system, you might need to adjust the symbol <code>PCLP</code> at the top of the batch file, to the PCLP installation directory on your computer.</dd></dl>
<p>The <code>lin.bat</code> batch file invoked without any command-line options checks the code in the default configuration corresponding to both <a href="https://www.state-machine.com/products/qtools#QPSpy" class="extern" target="_blank">QP/Spy</a> and <a href="https://www.state-machine.com/products/qtools#QUTest" class="extern" target="_blank">QUTest</a> support <b>enabled</b>. But the <code>lin.bat</code> batch can also be invoked with the option <code>-uQ_SPY</code> to <em>disable</em> the the QP/Spy instrumentation and additionally <code>-uQUTest</code> to <em>disable</em> in the unit testing support.</p>
<p>According to the PCLP guidelines, the <code>lin.bat</code> configuration file uses two option files: the <a href="std_8lnt_source.html">std.lnt</a> option file discussed before and the <a class="el" href="options_8lnt.html" title="PC-Lint-Plus option file for linting QP/C source code.">options.lnt</a> file covers all deviations from the MISRA-C guidelines in the QP Framework code. Section <a class="el" href="csc_gcs.html">Guideline Compliance Summary (GCS)</a> cross-references all these deviations, while Section <a class="el" href="csc_dev.html">Deviations</a> describes the reasons for deviations in those, very specific contexts.</p>
<h1><a class="anchor" id="csc_qpc"></a>
Compliance of QP Framework Code</h1>
<p>The compliance of the <b>QP Framework code</b> is checked by a combination of automatic analysis with PCLP and manual inspection, for guidelines unsupported by the PCLP tool or uncheckable by static analysis. The results of the automatic checks are provided in the PCLP log files (see <a class="el" href="csc_gep.html#csc_l1">Listing MISRA-1</a>). The summary of MISRA compliance is presented in Section <a class="el" href="csc_gcs.html">Guideline Compliance Summary (GCS)</a>, specifically in the <a class="el" href="csc_gcs.html#csc_gcs-conv">column QP/C</a> of the <a class="el" href="csc_gcs.html#csc_matrix">MISRA Compliance Matrix</a>.</p>
<dl class="section note"><dt>Note</dt><dd>QP Framework contains several components that are mutually exclusive, meaning that they cannot be simultaneously present in a given QP Application. For example, only one of the built-in real-time kernels (such as <a class="el" href="srs_qv.html">QV</a>, <a class="el" href="srs_qk.html">QK</a>, and <a class="el" href="srs_qxk.html">QXK</a>) can be used at a time. Also, in QP Framework configurations based on a 3rd-party RTOS kernel, none of the built-in kernel components are present. The implications for MISRA compliance are that only a <b>fraction</b> of the deviations listed in the <a class="el" href="csc_gcs.html#csc_matrix">MISRA Compliance Matrix</a> actually apply to any given QP use scenario.</dd></dl>
<p>The PCLP analysis is simple and requires invoking the <code>lin.bat</code> file from the <code>qpc/ports/lint-plus/</code> sub-directory.</p>
<dl class="section remark"><dt>Remarks</dt><dd>In order to execute the <code>lin.bat</code> file on your system, you might need to adjust the symbol <code>PCLP</code> at the top of the batch file, to the PCLP installation directory on your computer.</dd></dl>
<h2><a class="anchor" id="csc_qpc-logs"></a>
Compliance Evidence</h2>
<p>The PLCP output from static analysis of the QP Framework source code, as described in this section, is produced into the logs preserved in the <code>&lt;qpc&gt;/ports/lint-plus/</code> folder.</p>
<p><a class="anchor" id="csc_l3"></a></p><div class="caption"><center><em>Listing MISRA-3: PCLP output logs in the qpc/ports/lint-plus/ folder</em></center></div> <div class="fragment"><div class="line">qpc/                            <span class="comment">// QP/C installation directory</span></div>
<div class="line">|</div>
<div class="line">+---...</div>
<div class="line">|</div>
<div class="line">+---ports/                      <span class="comment">// QP/C ports directory</span></div>
<div class="line">|   |</div>
<div class="line">|   +---lint-plus/              <span class="comment">// QP/C &quot;port&quot; to PCLP</span></div>
<div class="line">|   |   +---.../</div>
<div class="line">|   |   |</div>
<div class="line">|   |   |   lin.bat             <span class="comment">// Batch file to invoke PCLP to analyze QP/C</span></div>
<div class="line">|   |   |</div>
<div class="line">|   |   |   lint_qf.log         <span class="comment">// PCLP output for the QF component of QP/C</span></div>
<div class="line">|   |   |   lint_qk.log         <span class="comment">// PCLP output for the QK component of QP/C</span></div>
<div class="line">|   |   |   lint_qs.log         <span class="comment">// PCLP output for the QS component of QP/C</span></div>
<div class="line">|   |   |   lint_qv.log         <span class="comment">// PCLP output for the QV component of QP/C</span></div>
<div class="line">|   |   |   lint_qxk.log        <span class="comment">// PCLP output for the QXK component of QP/C</span></div>
</div><!-- fragment --><h1><a class="anchor" id="csc_app"></a>
Compliance of QP Application Code</h1>
<p>Checking compliance of the <b>QP Application code</b> is demonstrated in the following examples (included in the QP/C distribution):</p>
<ul>
<li><code>qpc/examples/posix-win32/calc1_sub</code></li>
</ul>
<p><a class="anchor" id="csc_l4"></a></p><div class="caption"><center><em>Listing MISRA-4: directories and files for static analysis of Application code.</em></center></div> <div class="fragment"><div class="line">app/                 <span class="comment">// QP Application directory</span></div>
<div class="line">|</div>
<div class="line">+---lint-plus/       <span class="comment">// Directory for &quot;linting&quot; the application code with PLCP</span></div>
<div class="line">|   |  lin.bat       <span class="comment">// Batch file to invoke PCLP to analyze QP Framework</span></div>
<div class="line">|   |</div>
<div class="line">|   |  lint_out.log  <span class="comment">// PCLP output</span></div>
<div class="line">|   |  options.lnt   <span class="comment">// PCLP settings for &quot;linting&quot; QP Framework code</span></div>
<div class="line">|   |</div>
<div class="line">|   +--- ~ ~ ~       <span class="comment">// QP Application code...</span></div>
</div><!-- fragment --><p>The PCLP analysis is simple and requires invoking the <code>lin.bat</code> file from the <code>lint-plus/</code> sub-directory. The <code>lint-plus</code> sub-directory in each of the application folders contains also the <a class="el" href="options_8lnt.html" title="PC-Lint-Plus option file for linting QP/C source code.">options.lnt</a> with the PCLP options <b>specific to linting the application</b>.</p>
<dl class="section remark"><dt>Remarks</dt><dd>In order to execute the <code>lin.bat</code> file on your system, you might need to adjust the symbol <code>PCLP</code> at the top of the batch file, to the PCLP installation directory on your computer.</dd></dl>
<p><a class="anchor" id="csc_l5"></a></p><div class="caption"><center><em>Listing MISRA-5: PCLP configuration file for analyzing a QP Application.</em></center></div> <div class="fragment"><div class="line"><span class="comment">// general options</span></div>
<div class="line">-unit_check        <span class="comment">// perform only subset check (suppresses Global Wrapup)</span></div>
<div class="line">-max_threads=1     <span class="comment">// suppress message &quot;no &#39;-max_threads=N&#39; option&quot;</span></div>
<div class="line"><span class="comment">//-vf              // print names of all source files (for debugging linting)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// include directories</span></div>
<div class="line">-i..               <span class="comment">// application includes</span></div>
<div class="line">-i%QPC%\include    <span class="comment">// QP/C public includes</span></div>
<div class="line">-i%QPC_LINT%       <span class="comment">// QP/C lint &quot;port&quot;</span></div>
<div class="line">-i%QPC_LINT%\qk    <span class="comment">// QP/C lint &quot;port&quot; to QK</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// standards</span></div>
<div class="line">%QPC_LINT%\au-misra4.lnt       <span class="comment">// MISRA-C:2023 options</span></div>
<div class="line">%QPC_LINT%\au-barr.lnt         <span class="comment">// BARR-C:2018</span></div>
<div class="line">%QPC_LINT%\au-ds.lnt           <span class="comment">// Dan Saks recommendations</span></div>
<div class="line"><span class="comment">//-strong(AXJ)     // Strong type checking</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// size/alignment options (included from ports/lint-plus/??bits)</span></div>
<div class="line">cpu.lnt            <span class="comment">// for the chosen CPU</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// defined macros (might be undefined on command-line with -u&lt;macro&gt;)</span></div>
<div class="line">-dQ_SPY</div>
<div class="line">-dQ_UTEST</div>
<div class="line">-dQP_API_VERSION=9999 <span class="comment">// the latest API only</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//============================================================================</span></div>
<div class="line"><span class="comment">// QP/C options for clients</span></div>
<div class="line">qpc.lnt            <span class="comment">// QP/C options (see Section Configuring PCLP)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//============================================================================</span></div>
<div class="line"><span class="comment">// additional suppression rules for building this application</span></div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>The provided PCLP configuration file <a class="el" href="options_8lnt.html" title="PC-Lint-Plus option file for linting QP/C source code.">options.lnt</a> is designed for analyzing standard-compliant C code without embedded extensions. Analyzing embedded code that uses embedded extensions to the C language (such as <code>#pragma</code>, <code>__attribute__()</code>, etc.) requires option files for the specific compilers (<code>co-iar-arm.lnt</code> file for IAR ARM and <code>co-gnu-arm.lnt</code> file GNU-ARM, respectively). These option files are provided in the QTools collection. The location of the QTools directory in your system is specified in the <a class="el" href="options_8lnt.html" title="PC-Lint-Plus option file for linting QP/C source code.">options.lnt</a> file, and you most likely need to adjust it for your system. The QTools collection is available for a separate download from <a href="https://github.com/QuantumLeaps/qtools">https://github.com/QuantumLeaps/qtools</a>.</dd></dl>
<h1><a class="anchor" id="csc_qspy"></a>
Compliance of QS Tracing Instrumentation</h1>
<p>The QP Framework contains <a class="el" href="srs_qs.html">QS software tracing instrumentation</a> (see also <a href="https://www.state-machine.com/products/qtools#QPSpy" class="extern" target="_blank">QP/Spy</a>). This instrumentation only becomes active in the <b>Spy build configuration</b> (macro <a class="el" href="cmd__options_8dox.html#a668b5df6d955d0b1c77227192078689b" title="The preprocessor switch to activate the QS software tracing instrumentation in QP/C and application c...">Q_SPY</a> defined), and is typically <em>inactive</em> in the Debug and Release build configurations.</p>
<p>In the context of MISRA-C compliance it is important to note that, by the nature of software tracing, the Spy build configuration transgresses many more MISRA-C guidelines than the standard configuration, both in the QP Framework code and in the QP Application code. However, these deviations occur only in the <em>Spy build configuration</em>, which typically is <b>not</b> the code shipped within a product.</p>
<dl class="section attention"><dt>Attention</dt><dd>In <b>safety-related</b> QP Application code as configured for the product release, the <a class="el" href="struct_q_s.html" title="Software tracing instrumentation, target-resident component (QS namespace emulated as a &quot;class&quot; in C)">QS</a> software tracing shall be <b>inactive</b> (the macro <a class="el" href="cmd__options_8dox.html#a668b5df6d955d0b1c77227192078689b" title="The preprocessor switch to activate the QS software tracing instrumentation in QP/C and application c...">Q_SPY</a> shall NOT be defined). In that case, the deviations cased by the <a class="el" href="struct_q_s.html" title="Software tracing instrumentation, target-resident component (QS namespace emulated as a &quot;class&quot; in C)">QS</a> tracing instrumentation are NOT present. Because of the special nature of software tracing, the MISRA-C deviations caused by the <a class="el" href="struct_q_s.html" title="Software tracing instrumentation, target-resident component (QS namespace emulated as a &quot;class&quot; in C)">QS</a> tracing instrumentation are <b>separated</b> from the deviations in the baseline code:<ul>
<li><a class="el" href="csc_dev.html#csc_dvp-qs">Deviation Permits for QS</a></li>
<li><a class="el" href="csc_dev.html#csc_dvr-qs">Deviation Records for QS</a></li>
</ul>
</dd></dl>
<h1><a class="anchor" id="csc_other"></a>
Beyond MISRA Guidelines</h1>
<p>Static analysis tools, like PCLP, typically check many more issues than only those captured in MISRA-C guidelines. Most of these checks are still valuable and the provided <a class="el" href="csc_gep.html#csc_pclp-config">PCLP configuration</a> does <b>not</b> suppress such checks, just because they go beyond MISRA-C. However, it is still necessary to keep the static analysis logs "clean" according to the <a class="el" href="csc_gep.html#csc_policy">contextual diagnostics suppression policy</a>. Consequently the deviations from PCLP checks also need to be documented and contextually suppressed. For that, this document contains the sections <a class="el" href="csc_dev.html#csc_dvp-pclp">Deviation Permits for PCLP</a> and <a class="el" href="csc_dev.html#csc_dvr-pclp">Deviation Records for PCLP</a>.</p>
<p><span class="prev_button"><a class="el" href="csc.html#csc_scope">Purpose and Scope</a></span><span class="next_button"><a class="el" href="csc_gcs.html">Guideline Compliance Summary (GCS)</a></span>  </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="csc.html">MISRA-C:2023 Compliance</a></li>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2024 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QP/C 7.3.4</b> &nbsp;|&nbsp; Updated on Thu Mar 21 2024
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2024 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QP/C 7.3.4</b> &nbsp;|&nbsp; Updated on Thu Mar 21 2024
</small></address>
    </li>
  </ul>
</div>
</body>
</html>
